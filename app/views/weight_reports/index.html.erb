<h1>Weight Reports</h1>

<%= link_to 'New Weight Report', new_weight_report_path, class: "btn btn-outline-primary" %>

<br><br>

<ul class="nav nav-tabs">
  <li class="nav-item">
    <a class="nav-link active" href="#table" data-toggle="tab">Reports</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="#charts" data-toggle="tab">Analysis</a>
  </li>
</ul>
<br>

<div class="tab-content">
  <div id="table" class="tab-pane active show">
    <table class="table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Weight</th>
          <th colspan="3"></th>
        </tr>
      </thead>

      <tbody>
        <% @weight_reports.ordered_by_recency.reverse.each do |weight_report| %>
          <tr>
            <td><%= weight_report.datestamp.strftime('%Y-%m-%d') %></td>
            <td><b><%= '%.1f' % weight_report.weight_pounds %></b> lb</td>
            <td nowrap>
              <%= link_to edit_weight_report_path(weight_report) do %>
                <%= octicon "pencil", :height => 16 %>
              <% end %>
              &nbsp;&nbsp;
              <%= link_to weight_report, method: :delete, data: { confirm: 'Are you sure?' } do %>
                <%= octicon "trashcan", :height => 16 %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <div id="charts" class="tab-pane">
    <h2>Statistics</h2>
    <hr>
    <table>
      <tr>
        <td><h3>30-day average: <b></h3></td>
        <td><h3><b><%= current_average_weight(days=30) %></b> lb</h3></td>
      </tr>
      <tr>
        <td><h3>1-year average: <b></h3></td>
        <td><h3><b><%= current_average_weight(days=365) %></b> lb</h3></td>
      </tr>
    </table>
    <br>
    <h2>Charts</h2>
    <hr> 
    <%= line_chart WeightReport.pluck(:datestamp, :weight_pounds),  min: 160, max: 190 %> 
  </div>
</div>